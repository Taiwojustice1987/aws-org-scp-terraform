      - name: Terraform Plan
        shell: bash
        run: |
          ROOT_TARGET_ID="$(printf '%s' "${{ secrets.ROOT_TARGET_ID }}" | tr -d '\r\n' | xargs)"
          DEV_OU_ID="$(printf '%s' "${{ secrets.DEV_OU_ID }}" | tr -d '\r\n' | xargs)"

          if [[ -z "$ROOT_TARGET_ID" || -z "$DEV_OU_ID" ]]; then
            echo "ERROR: ROOT_TARGET_ID or DEV_OU_ID is empty. Check GitHub Secrets."
            exit 1
          fi

          terraform plan -var="root_target_id=$ROOT_TARGET_ID" -var="dev_ou_id=$DEV_OU_ID"

      - name: Terraform Apply
        shell: bash
        run: |
          ROOT_TARGET_ID="$(printf '%s' "${{ secrets.ROOT_TARGET_ID }}" | tr -d '\r\n' | xargs)"
          DEV_OU_ID="$(printf '%s' "${{ secrets.DEV_OU_ID }}" | tr -d '\r\n' | xargs)"

          if [[ -z "$ROOT_TARGET_ID" || -z "$DEV_OU_ID" ]]; then
            echo "ERROR: ROOT_TARGET_ID or DEV_OU_ID is empty. Check GitHub Secrets."
            exit 1
          fi

          terraform apply -auto-approve -var="root_target_id=$ROOT_TARGET_ID" -var="dev_ou_id=$DEV_OU_ID"
